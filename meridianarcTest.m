tol = 1e-3; % tolerance of meridian arc calculation [m]
ellipsoidList = {'WGS84','WGS72','WGS66','WGS60','GRS80','NAD83','GDA94',...
    'AIR30','MdAIR','AusNS','AGD66','AGD84','INTER','IAU65','IAU68','GRS67',...
    'MdGRS','SAD69','CLK80','CLK66','NAD27','KRASO','ATS77','EVRST','BESSL'};

%% TEST 01: Meridian Distance
% Test Inputs
lat = -90:45:90;

% Expected Outputs (row = ellipsoid, col = latitude)
meridianDistance = [ ...
10001965.7293 4984944.3780 0.0000 4984944.3780 10001965.7293; ...
10001962.7492 4984943.0422 0.0000 4984943.0422 10001962.7492; ...
10001977.8682 4984950.0388 0.0000 4984950.0388 10001977.8682; ...
10002012.0444 4984969.7650 0.0000 4984969.7650 10002012.0444; ...
10001965.7292 4984944.3779 0.0000 4984944.3779 10001965.7292; ...
10001965.7292 4984944.3779 0.0000 4984944.3779 10001965.7292; ...
10001965.7292 4984944.3779 0.0000 4984944.3779 10001965.7292; ...
10001126.0807 4984583.2026 0.0000 4984583.2026 10001126.0807; ...
10000776.0534 4984408.7482 0.0000 4984408.7482 10000776.0534; ...
10002001.3906 4984961.7624 0.0000 4984961.7624 10002001.3906; ...
10002001.3906 4984961.7624 0.0000 4984961.7624 10002001.3906; ...
10002001.3906 4984961.7624 0.0000 4984961.7624 10002001.3906; ...
10002288.2990 4985037.1371 0.0000 4985037.1371 10002288.2990; ...
10002001.3906 4984961.7624 0.0000 4984961.7624 10002001.3906; ...
10002001.2331 4984961.5330 0.0000 4984961.5330 10002001.2331; ...
10002001.2312 4984961.5303 0.0000 4984961.5303 10002001.2312; ...
10002001.3906 4984961.7624 0.0000 4984961.7624 10002001.3906; ...
10002001.3906 4984961.7624 0.0000 4984961.7624 10002001.3906; ...
10001867.5516 4984633.0982 0.0000 4984633.0982 10001867.5516; ...
10001888.0430 4984727.1001 0.0000 4984727.1001 10001888.0430; ...
10001888.0430 4984727.1001 0.0000 4984727.1001 10001888.0430; ...
10002137.4975 4985032.2905 0.0000 4985032.2905 10002137.4975; ...
10001962.5804 4984942.7965 0.0000 4984942.7965 10001962.5804; ...
10000758.0157 4984478.3359 0.0000 4984478.3359 10000758.0157; ...
10000855.7644 4984439.2655 0.0000 4984439.2655 10000855.7644];

% Test
nEllipsoids = numel(ellipsoidList);
nTests = length(lat);
for m = 1:nEllipsoids
    ellipsoidName = ellipsoidList{m};
    [a,b] = refEllip(ellipsoidName);
    for n = 1:nTests
        meridianDistance0_bessel = meridianarc(lat(n),[a b],'Bessel');
        meridianDistance0_helmert = meridianarc(lat(n),[a b],'Helmert');
        meridianDistance0_utm = meridianarc(lat(n),[a b],'UTM');
        meridianDistance0_osgb = meridianarc(lat(n),[a b],'OSGB');
        meridianDistance0_bowring = meridianarc(lat(n),[a b],'Bowring');
        assert(all(([meridianDistance0_bessel, meridianDistance0_helmert, ...
            meridianDistance0_utm, meridianDistance0_osgb,  ...
            meridianDistance0_bowring] - meridianDistance(m,n)) <= tol));
    end         
end
  

